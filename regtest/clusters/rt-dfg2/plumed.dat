ones: ONES SIZE=1996
cmat: CONTACT_MATRIX GROUP=1-1996 SWITCH={CUBIC D_0=0.34 D_MAX=0.38}
c1: MATRIX_VECTOR_PRODUCT ARG=cmat,ones  
cf: LESS_THAN ARG=c1 SWITCH={CUBIC D_0=13 D_MAX=13.5} 
cf2: CUSTOM ARG=cf FUNC=x*x PERIODIC=NO

cmat2: CONTACT_MATRIX GROUP=1-1996 SWITCH={CUBIC D_0=0.34 D_MAX=0.38}
dmat: OUTER_PRODUCT ARG=cf,cf
mat: CUSTOM ARG=cmat2,dmat FUNC=x*y PERIODIC=NO
dfs: DFSCLUSTERING ARG=mat 

clust1: CLUSTER_PROPERTIES ARG=cf2 CLUSTERS=dfs CLUSTER=1 SUM
clust2: CLUSTER_PROPERTIES ARG=cf2 CLUSTERS=dfs CLUSTER=2 SUM
clust3: CLUSTER_PROPERTIES ARG=cf2 CLUSTERS=dfs CLUSTER=3 SUM
clust4: CLUSTER_PROPERTIES ARG=cf2 CLUSTERS=dfs CLUSTER=4 SUM  
PRINT ARG=clust1.*,clust2.*,clust3.*,clust4.* FILE=colvar

OUTPUT_CLUSTER ATOMS=1-1996 CLUSTERS=dfs CLUSTER=1 FILE=dfs.ndx

clust2a: CLUSTER_WITHSURFACE ATOMS=1-1996 CLUSTERS=dfs CLUSTER=2 RCUT_SURF={CUBIC D_0=0.34 D_MAX=0.38} 
size2a: SUM ARG=clust2a PERIODIC=NO
dia2a: CLUSTER_DIAMETER ATOMS=1-1996 ARG=clust2a
PRINT ARG=size2a,dia2a FILE=size FMT=%8.4f
PRINT_NDX ATOMS=1-1996 ARG=clust2a GREATER_THAN_OR_EQUAL=0.9 FILE=dfs2.ndx
