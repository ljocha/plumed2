# Test of row/column sums for symmetric matrix

mat: CONTACT_MATRIX GROUP=1-10 SWITCH={RATIONAL R_0=1.0} 
ones: ONES SIZE=10
csums: MATRIX_VECTOR_PRODUCT ARG=mat,ones
csums_mean: MEAN ARG=csums PERIODIC=NO
rsums: MATRIX_VECTOR_PRODUCT ARG=mat,ones 
rsums_mean: MEAN ARG=rsums PERIODIC=NO

COORDINATIONNUMBER SPECIES=1-10 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1
PRINT ARG=c1.*,csums_mean,rsums_mean STRIDE=1 FILE=colvar FMT=%8.4f
 
# Test of row/column sums + around for symmetric matrix

ac: AROUND ORIGIN=1 ATOMS=1-10 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0
acp: MATHEVAL ARG=csums,ac FUNC=x*y PERIODIC=NO
a1_numer: SUM ARG=acp PERIODIC=NO
a1_denom: SUM ARG=ac PERIODIC=NO
a1_mean: MATHEVAL ARG=a1_numer,a1_denom FUNC=x/y PERIODIC=NO
AROUND ORIGIN=1 DATA=rsums ATOMS=1-10 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a2
AROUND ORIGIN=1 DATA=c1 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a3

PRINT ARG=a1_mean,a2.*,a3.* FILE=colv-around FMT=%8.4f

# Test of row/column sums for rectangular matrix

CONTACT_MATRIX GROUPA=1-5 GROUPB=6-15 SWITCH={RATIONAL R_0=1.0} LABEL=mat2 
rones: ONES SIZE=10
rsums2: MATRIX_VECTOR_PRODUCT ARG=mat2,rones 
rsums2_mean: MEAN ARG=rsums2 PERIODIC=NO
csums2T: TRANSPOSE ARG=mat2
cones: ONES SIZE=5
csums2:  MATRIX_VECTOR_PRODUCT ARG=csums2T,cones 
csums2_mean: MEAN ARG=csums2 PERIODIC=NO 

COORDINATIONNUMBER SPECIESA=1-5 SPECIESB=6-15 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1r
COORDINATIONNUMBER SPECIESA=6-15 SPECIESB=1-5 SWITCH={RATIONAL R_0=1.0} MEAN LABEL=c1c

PRINT ARG=c1r.*,rsums2_mean,c1c.*,csums2_mean FILE=colv2 FMT=%8.4f

# Test of row/column sums + around for rectangular matrix

ac2: AROUND ORIGIN=6 ATOMS=6-15 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0
acp2: MATHEVAL ARG=csums2,ac2 FUNC=x*y PERIODIC=NO
a4_numer: SUM ARG=acp2 PERIODIC=NO
a4_denom: SUM ARG=ac2 PERIODIC=NO
a4_mean: MATHEVAL ARG=a4_numer,a4_denom FUNC=x/y PERIODIC=NO
AROUND ORIGIN=6 DATA=c1c SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a5
AROUND ORIGIN=1 DATA=rsums2 ATOMS=1-5 SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a6
AROUND ORIGIN=1 DATA=c1r SIGMA=0.2 XLOWER=-1.0 XUPPER=1.0 MEAN LABEL=a7

PRINT ARG=a4_mean,a5.*,a6.*,a7.* FILE=colv-around-2 FMT=%8.4f

